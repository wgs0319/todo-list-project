<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>í”„ë¡œì íŠ¸ ëª©ë¡</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 50px auto;
            padding: 20px;
        }
        .nav {
            background: white;
            padding: 15px 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        .nav a {
            margin-right: 15px;
            color: #4CAF50;
            text-decoration: none;
            font-weight: bold;
        }
        .nav a:hover {
            text-decoration: underline;
        }

        /* ê²€ìƒ‰ ì„¹ì…˜ */
        .search-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .search-form {
            display: flex;
            gap: 10px;
        }
        .search-form input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        .search-form button {
            padding: 10px 30px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .search-form button:hover {
            background-color: #45a049;
        }
        .btn-reset {
            background-color: #808080 !important;
        }
        .btn-reset:hover {
            background-color: #666 !important;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #4CAF50;
            color: white;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .btn {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            display: inline-block;
            margin-bottom: 10px;
        }
        .btn:hover {
            background-color: #45a049;
        }
        .search-result {
            background-color: #e7f3fe;
            padding: 10px 15px;
            border-left: 4px solid #2196F3;
            margin-bottom: 15px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
<div class="nav">
    <a href="/">í™ˆ</a>
    <a href="/users/list">ì‚¬ìš©ì ëª©ë¡</a>
    <a href="/projects/list">í”„ë¡œì íŠ¸ ëª©ë¡</a>
    <a href="/tasks/list">ì‘ì—… ëª©ë¡</a>

    <!-- ë¡œê·¸ì¸ ì •ë³´ -->
    <div style="margin-left: auto; display: flex; align-items: center; gap: 15px;">
        <span th:if="${session.loginUser}" style="color: #333;">
            ğŸ‘¤ <strong th:text="${session.loginUser.name}"></strong>ë‹˜
        </span>
        <a href="/logout" style="color: #f44336;">ë¡œê·¸ì•„ì›ƒ</a>
    </div>
</div>

<!-- ê²€ìƒ‰ ì„¹ì…˜ -->
<div class="search-section">
    <h3>ğŸ” í”„ë¡œì íŠ¸ ê²€ìƒ‰</h3>
    <form th:action="@{/projects/list}" method="get" class="search-form">
        <input type="text"
               name="keyword"
               placeholder="í”„ë¡œì íŠ¸ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
               th:value="${selectedKeyword}">
        <button type="submit">ê²€ìƒ‰</button>
        <a href="/projects/list">
            <button type="button" class="btn-reset">ì´ˆê¸°í™”</button>
        </a>
    </form>
</div>

<!-- ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ -->
<div th:if="${selectedKeyword != null && !selectedKeyword.isEmpty()}" class="search-result">
    <strong>ê²€ìƒ‰ì–´:</strong> "<span th:text="${selectedKeyword}"></span>"
    - <span th:text="${#lists.size(projects)}"></span>ê°œì˜ ê²°ê³¼ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.
</div>

<div class="header">
    <h1>í”„ë¡œì íŠ¸ ëª©ë¡</h1>
    <a th:if="${session.loginUser != null && session.loginUser.role.name() != 'VIEWER'}"
       href="/projects/create"
       class="btn">ìƒˆ í”„ë¡œì íŠ¸ ë§Œë“¤ê¸°</a>
</div>

<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>ì œëª©</th>
        <th>ì„¤ëª…</th>
        <th>ìƒì„±ì¼</th>
        <th>ì‘ì—…</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="project : ${projects}">
        <td th:text="${project.id}"></td>
        <td th:text="${project.title}"></td>
        <td th:text="${project.description}"></td>
        <td th:text="${#temporals.format(project.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
        <td>
            <a th:href="@{/projects/{id}(id=${project.id})}" style="margin-right: 5px;">ìƒì„¸</a>
            <a th:href="@{/projects/{id}/edit(id=${project.id})}" style="margin-right: 5px;">ìˆ˜ì •</a>
            <a th:href="@{/tasks/list(projectId=${project.id})}" style="margin-right: 5px; color: #2196F3;">ì‘ì—…ë³´ê¸°</a>
            <form th:action="@{/projects/{id}/delete(id=${project.id})}" method="post"
                  style="display: inline;"
                  onsubmit="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                <button type="submit" style="background: none; border: none; color: #f44336; cursor: pointer; text-decoration: underline;">ì‚­ì œ</button>
            </form>
        </td>
    </tr>
    <tr th:if="${#lists.isEmpty(projects)}">
        <td colspan="5" style="text-align: center;">
                    <span th:if="${selectedKeyword != null && !selectedKeyword.isEmpty()}">
                        ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.
                    </span>
            <span th:unless="${selectedKeyword != null && !selectedKeyword.isEmpty()}">
                        ë“±ë¡ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.
                    </span>
        </td>
    </tr>
    </tbody>
</table>
</body>
</html>